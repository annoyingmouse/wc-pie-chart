{"version":3,"file":"wc-pie-chart-min.js","sources":["../wc-pie-chart.js"],"sourcesContent":["class WCPieChart extends HTMLElement {\n  static get observedAttributes() {\n    return ['width', 'duration', 'delay', 'thickness']\n  }\n  get style() {\n    return `\n      <style>\n        :host {\n          --width: ${this.width} \n        }\n        * {\n          box-sizing: border-box;\n        }\n        div {\n          width: calc(var(--width)*1px);\n          height: calc(var(--width)*1px);\n          position: relative;\n        }\n      </style>`\n  }\n  constructor() {\n    super()\n    this.shadow = this.attachShadow({\n      mode: 'closed',\n    })\n    this.shadow.innerHTML = `${this.style}<div></div>`\n    try {\n      window.CSS.registerProperty({\n        name: '--p',\n        syntax: '<number>',\n        inherits: true,\n        initialValue: 0,\n      })\n    } catch (e) {\n      if (e.name === 'InvalidModificationError') {\n        return // We've already added it before!\n      } else {\n        console.warn(\n          'Browser does not support animated conical gradients',\n          e.name\n        )\n      }\n    }\n  }\n  render() {\n    if (Array.isArray(this.segments)) {\n      const segments = [...this.segments]\n      const total = segments.reduce(\n        (p, c) => p + Number(c.getAttribute('value')),\n        0\n      )\n      let durationTotal = this.delay\n      let rotationTotal = 0\n      const totalDegree = 360 / total\n      segments.forEach((segment) => {\n        const value = Number(segment.getAttribute('value'))\n        const currentRotation = totalDegree * value\n        const animationDuration =\n          currentRotation / (360 / Number(this.duration))\n        segment.setAttribute('thickness', this.thickness * this.width)\n        segment.setAttribute('end', (value / total) * 100)\n        segment.setAttribute('rotate', rotationTotal)\n        segment.setAttribute('delay', durationTotal)\n        segment.setAttribute('duration', animationDuration)\n        segment.setAttribute('width', this.width)\n        rotationTotal += currentRotation\n        durationTotal += animationDuration\n        this.div.append(segment)\n      })\n    }\n  }\n  connectedCallback() {\n    this.div = this.shadow.querySelector('div')\n    this.segments = [...this.querySelectorAll('wc-pie-slice')]\n    this.render()\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (newValue !== oldValue) {\n      this.shadow.innerHTML = `${this.style}<div></div>`\n      this.div = this.shadow.querySelector('div')\n      this.render()\n    }\n  }\n  get width() {\n    return Number(this.getAttribute('width')) || 150\n  }\n  get duration() {\n    return Number(this.getAttribute('duration')) || 2000\n  }\n  get delay() {\n    return Number(this.getAttribute('delay')) || 500\n  }\n  get thickness() {\n    return Number(this.getAttribute('thickness')) || 0.2\n  }\n}\n\nclass WCPieSlice extends HTMLElement {\n  static get observedAttributes() {\n    return ['width', 'duration', 'delay', 'color', 'thickness', 'rotate']\n  }\n  get style() {\n    return `\n      <style>\n        * {\n          box-sizing: border-box;\n        }\n        div {\n          --p: ${this.end};\n          width: ${this.width}px;\n          aspect-ratio: 1;\n          margin: 0;\n          position: absolute;\n          left: 50%;\n          top: 50%;\n          animation-name: p;\n          animation-fill-mode: both;\n          animation-timing-function: ease-in-out;\n          transform: translate(-50%, -50%);\n          animation-duration: ${this.duration}ms;\n          animation-delay: ${this.delay}ms;\n        }\n        div:before {\n          content: \"\";\n          position: absolute;\n          border-radius: 50%;\n          inset: 0;\n          background: conic-gradient(from ${this.rotate}deg, ${this.specifiedColour} calc(var(--p)*1%), transparent 0);\n          -webkit-mask: radial-gradient(farthest-side, transparent calc(99% - ${this.thickness}px), #000 calc(100% - ${this.thickness}px));\n          mask: radial-gradient(farthest-side, transparent calc(99% - ${this.thickness}px), #000 calc(100% - ${this.thickness}px));\n        }\n        @keyframes p {\n          from {\n            --p: 0;\n          }\n        }\n      </style>\n    `\n  }\n  constructor() {\n    super()\n    this.shadow = this.attachShadow({\n      mode: 'closed',\n    })\n    this.specifiedColour = this.color\n  }\n  render() {\n    this.shadow.innerHTML = `${this.style}<div></div>`\n  }\n  connectedCallback() {\n    this.render()\n  }\n  attributeChangedCallback(name, oldValue, newValue) {\n    this.render()\n  }\n  get width() {\n    return Number(this.getAttribute('width'))\n  }\n  get duration() {\n    return Number(this.getAttribute('duration'))\n  }\n  get delay() {\n    return Number(this.getAttribute('delay'))\n  }\n  get color() {\n    return this.getAttribute('color') || this.getRandomColor\n  }\n  get thickness() {\n    return Number(this.getAttribute('thickness'))\n  }\n  get rotate() {\n    return Number(this.getAttribute('rotate'))\n  }\n  get end() {\n    return Number(this.getAttribute('end'))\n  }\n  get getRandomColor() {\n    const letters = '0123456789ABCDEF'\n    let color = '#'\n    for (let i = 0; i < 6; i++) {\n      color += letters[Math.floor(Math.random() * 16)]\n    }\n    return color\n  }\n}\n\nwindow.customElements.define('wc-pie-chart', WCPieChart)\nwindow.customElements.define('wc-pie-slice', WCPieSlice)\n"],"names":["WCPieChart","HTMLElement","observedAttributes","style","this","width","constructor","super","shadow","attachShadow","mode","innerHTML","window","CSS","registerProperty","name","syntax","inherits","initialValue","e","console","warn","render","Array","isArray","segments","total","reduce","p","c","Number","getAttribute","durationTotal","delay","rotationTotal","totalDegree","forEach","segment","value","currentRotation","animationDuration","duration","setAttribute","thickness","div","append","connectedCallback","querySelector","querySelectorAll","attributeChangedCallback","oldValue","newValue","WCPieSlice","end","rotate","specifiedColour","color","getRandomColor","i","Math","floor","random","customElements","define"],"mappings":"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"}